export RUST_BACKTRACE=1

if [[ -z "${RIPGREP_CONFIG_PATH:-}" ]]; then
    export RIPGREP_CONFIG_PATH=$HOME/.config/ripgrep/ripgreprc
fi

# dirty hacks
if [[ -z "$SSH_AUTH_SOCK" && $HOST == "tail-bot" ]]; then
    export SSH_AUTH_SOCK=/tmp/$USER/ssh-agent.sock
fi

# Ensure that a non-login, non-interactive shell has a defined environment.
if [[ ( "$SHLVL" -eq 1 && ! -o LOGIN ) && -s "${ZDOTDIR:-$HOME}/.zprofile" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprofile"
fi

# Set up Nix only on SSH connections
# See: https://github.com/DeterminateSystems/nix-installer/pull/714
if [ -e '/nix/var/nix/profiles/default/etc/profile.d/nix-daemon.sh' ] && [ -n "${SSH_CONNECTION}" ] && [ "${SHLVL}" -eq 1 ]; then
    . '/nix/var/nix/profiles/default/etc/profile.d/nix-daemon.sh'
fi
# End Nix

